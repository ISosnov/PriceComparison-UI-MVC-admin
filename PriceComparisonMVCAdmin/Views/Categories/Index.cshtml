@model List<PriceComparisonMVCAdmin.Models.DTOs.Response.Category.CategoryResponseModel>
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";

    var categoryTitleMap = Model.ToDictionary(cat => cat.Id, cat => cat.Title);
}

<div class="container my-4">
    <h2 class="mb-3">Категорії</h2>

    @if (Model != null && Model.Any())
    {
        <!-- Обгортка для всіх рядків -->
        <div class="d-flex flex-column">

            <!-- Рядок заголовків -->
            <div class="row fw-bold border-bottom py-2">
                <div class="col-1 text-center">Id</div>
                <div class="col-3 text-center">Назва</div>
                <div class="col-2 text-center">Батьківська ID</div>
                <div class="col-3 text-center">Батьківська</div>
                <div class="col-1 text-center">Порядок</div>
                <div class="col-2 text-center">Дії</div>
            </div>

            <!-- Рядки даних -->
            @foreach (var item in Model)
            {
                <div class="row align-items-center border-bottom py-2">
                    <div class="col-1 text-center">@item.Id</div>
                    <div class="col-3 text-center">@item.Title</div>
                    <div class="col-2 text-center">
                        @(item.ParentCategoryId.HasValue ? item.ParentCategoryId.ToString() : "Немає")
                    </div>

                    <div class="col-3 text-center">
                        @if (item.ParentCategoryId.HasValue && categoryTitleMap.TryGetValue(item.ParentCategoryId.Value, out var parentTitle))
                        {
                            @parentTitle
                        }
                        else
                        {
                            <text>Немає</text>
                        }
                    </div>
                    <div class="col-1 text-center">@item.DisplayOrder</div>
                    <div class="col-2 text-center">
                        <!-- Кнопка редагування з піктограмою (олівець) -->
                        <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-link" title="Редагувати">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                 fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
                                <path d="M12.146.146a.5.5 0 0 1 .708 0l3
                                       3a.5.5 0 0 1 0 .708l-10
                                       10a.5.5 0 0 1-.168.11l-5
                                       2a.5.5 0 0 1-.65-.65l2-5a.5.5
                                       0 0 1 .11-.168zM11.207
                                       2.5 13.5 4.793 14.793 3.5
                                       12.5 1.207zm1.586
                                       3L10.5 3.207 4
                                       9.707V10h.5a.5.5 0 0
                                       1 .5.5v.5h.5a.5.5 0 0
                                       1 .5.5v.5h.293zm-9.761
                                       5.175-.106.106-1.528
                                       3.821 3.821-1.528.106-.106A.5.5
                                       0 0 1 5 12.5V12h-.5a.5.5
                                       0 0 1-.5-.5V11h-.5a.5.5
                                       0 0 1-.468-.325" />
                            </svg>
                        </a>
                        <!-- Кнопка видалення з піктограмою (кошик) -->
                        <form asp-action="Delete" asp-route-id="@item.Id" method="post"
                              class="d-inline" onsubmit="return confirm('Видалити категорію?');">
                            <button type="submit" class="btn btn-sm btn-link" title="Видалити">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                     fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                    <path d="M5.5 5.5A.5.5 0 0 1 6 5h4a.5.5
                                           0 0 1 .5.5V6h1v9a2 2 0 0
                                           1-2 2H6.5a2 2 0 0 1-2-2V6h1v-.5zm3
                                           0v9h1V5.5h-1zm-2 0v9h1V5.5h-1z" />
                                    <path fill-rule="evenodd"
                                          d="M14.5 3a1 1 0 0 1-1
                                               1H13v9a2 2 0 0 1-2
                                               2H5a2 2 0 0 1-2-2V4h-.5a1
                                               1 0 0 1 0-2h3.5l1-1h3l1
                                               1h3.5a1 1 0 0 1 1
                                               1zM4.118 4L4 4.059V4h8v.059L11.882
                                               4H4.118z" />
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <p>Немає категорій</p>
    }

    <div class="text-center">
        <a asp-action="Create" class="btn btn-primary d-inline-flex align-items-center justify-content-center mt-3">
            Створити категорію
        </a>
    </div>
</div>
